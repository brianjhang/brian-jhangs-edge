// 實體關聯映射表 - 為重要概念提供權威來源連結
// 用於 GEO 優化，幫助 AI 搜尋引擎更好地理解專業術語

export const entityMapping = {
  // AI 相關實體
  'ChatGPT': [
    'https://openai.com/chatgpt',
    'https://en.wikipedia.org/wiki/ChatGPT',
    'https://zh.wikipedia.org/wiki/ChatGPT'
  ],
  'Claude': [
    'https://claude.ai',
    'https://en.wikipedia.org/wiki/Claude_(chatbot)',
    'https://zh.wikipedia.org/wiki/Claude_(%E8%81%8A%E5%A4%A9%E6%A9%9F%E5%99%A8%E4%BA%BA)'
  ],
  'Perplexity AI': [
    'https://perplexity.ai',
    'https://en.wikipedia.org/wiki/Perplexity_AI'
  ],
  'OpenAI': [
    'https://openai.com',
    'https://en.wikipedia.org/wiki/OpenAI',
    'https://zh.wikipedia.org/wiki/OpenAI'
  ],
  'Anthropic': [
    'https://anthropic.com',
    'https://en.wikipedia.org/wiki/Anthropic'
  ],
  'Google Gemini': [
    'https://gemini.google.com',
    'https://en.wikipedia.org/wiki/Gemini_(chatbot)'
  ],
  'Transformer': [
    'https://en.wikipedia.org/wiki/Transformer_(machine_learning_model)',
    'https://arxiv.org/abs/1706.03762'
  ],
  'RAG': [
    'https://en.wikipedia.org/wiki/Retrieval-augmented_generation'
  ],
  'LLM': [
    'https://en.wikipedia.org/wiki/Large_language_model',
    'https://zh.wikipedia.org/wiki/%E5%A4%A7%E5%9E%8B%E8%AA%9E%E8%A8%80%E6%A8%A1%E5%9E%8B'
  ],
  'Midjourney': [
    'https://midjourney.com',
    'https://en.wikipedia.org/wiki/Midjourney'
  ],

  // 加密貨幣相關實體
  'Bitcoin': [
    'https://bitcoin.org',
    'https://en.wikipedia.org/wiki/Bitcoin',
    'https://zh.wikipedia.org/wiki/%E6%AF%94%E7%89%B9%E5%B9%A3',
    'https://coinmarketcap.com/currencies/bitcoin/'
  ],
  'Ethereum': [
    'https://ethereum.org',
    'https://en.wikipedia.org/wiki/Ethereum',
    'https://zh.wikipedia.org/wiki/%E4%BB%A5%E5%A4%AA%E5%9D%8A',
    'https://coinmarketcap.com/currencies/ethereum/'
  ],
  'Solana': [
    'https://solana.com',
    'https://en.wikipedia.org/wiki/Solana_(blockchain_platform)',
    'https://coinmarketcap.com/currencies/solana/'
  ],
  'Binance Coin': [
    'https://www.binance.com/en/bnb',
    'https://coinmarketcap.com/currencies/bnb/'
  ],
  'Cardano': [
    'https://cardano.org',
    'https://en.wikipedia.org/wiki/Cardano_(blockchain_platform)',
    'https://coinmarketcap.com/currencies/cardano/'
  ],
  'Chainlink': [
    'https://chain.link',
    'https://en.wikipedia.org/wiki/Chainlink',
    'https://coinmarketcap.com/currencies/chainlink/'
  ],
  'Dogecoin': [
    'https://dogecoin.com',
    'https://en.wikipedia.org/wiki/Dogecoin',
    'https://zh.wikipedia.org/wiki/%E7%8B%97%E7%8B%97%E5%B9%A3',
    'https://coinmarketcap.com/currencies/dogecoin/'
  ],
  'USDT': [
    'https://tether.to',
    'https://en.wikipedia.org/wiki/Tether_(cryptocurrency)',
    'https://coinmarketcap.com/currencies/tether/'
  ],
  'USDC': [
    'https://centre.io',
    'https://coinmarketcap.com/currencies/usd-coin/'
  ],
  'Avalanche': [
    'https://avax.network',
    'https://coinmarketcap.com/currencies/avalanche/'
  ],
  'Polygon': [
    'https://polygon.technology',
    'https://coinmarketcap.com/currencies/polygon/'
  ],
  'TRON': [
    'https://tron.network',
    'https://coinmarketcap.com/currencies/tron/'
  ],

  // 創業相關實體
  'Naval Ravikant': [
    'https://nav.al',
    'https://en.wikipedia.org/wiki/Naval_Ravikant',
    'https://twitter.com/naval'
  ],
  'Peter Thiel': [
    'https://en.wikipedia.org/wiki/Peter_Thiel',
    'https://zh.wikipedia.org/wiki/%E5%BD%BC%E5%BE%97%C2%B7%E6%8F%90%E7%88%BE'
  ],
  'Jeff Bezos': [
    'https://en.wikipedia.org/wiki/Jeff_Bezos',
    'https://zh.wikipedia.org/wiki/%E5%82%91%E5%A4%AB%C2%B7%E8%B2%9D%E4%BD%90%E6%96%AF'
  ],
  'Ben Horowitz': [
    'https://en.wikipedia.org/wiki/Ben_Horowitz'
  ],
  'Y Combinator': [
    'https://ycombinator.com',
    'https://en.wikipedia.org/wiki/Y_Combinator',
    'https://zh.wikipedia.org/wiki/Y_Combinator'
  ],
  'Lean Startup': [
    'https://en.wikipedia.org/wiki/Lean_startup',
    'https://zh.wikipedia.org/wiki/%E7%B2%BE%E5%AF%A6%E5%89%B5%E6%A5%AD'
  ],
  'MVP': [
    'https://en.wikipedia.org/wiki/Minimum_viable_product',
    'https://zh.wikipedia.org/wiki/%E6%9C%80%E7%B0%A1%E5%8F%AF%E8%A1%8C%E7%94%A2%E5%93%81'
  ],

  // 區塊鏈技術相關
  'Blockchain': [
    'https://en.wikipedia.org/wiki/Blockchain',
    'https://zh.wikipedia.org/wiki/%E5%8C%BA%E5%9D%97%E9%93%BE'
  ],
  'DeFi': [
    'https://en.wikipedia.org/wiki/Decentralized_finance',
    'https://zh.wikipedia.org/wiki/%E5%8E%BB%E4%B8%AD%E5%BF%83%E5%8C%96%E9%87%91%E8%9E%8D'
  ],
  'NFT': [
    'https://en.wikipedia.org/wiki/Non-fungible_token',
    'https://zh.wikipedia.org/wiki/%E9%9D%9E%E5%90%8C%E8%B3%AA%E5%8C%96%E4%BB%A3%E5%B9%A3'
  ],
  'Web3': [
    'https://en.wikipedia.org/wiki/Web3',
    'https://zh.wikipedia.org/wiki/Web3'
  ]
};

/**
 * 根據關鍵詞獲取相關的實體連結
 * @param {string} keyword 關鍵詞
 * @returns {Array} 相關實體連結數組
 */
export function getEntityLinks(keyword) {
  // 精確匹配
  if (entityMapping[keyword]) {
    return entityMapping[keyword];
  }

  // 模糊匹配
  const normalizedKeyword = keyword.toLowerCase().replace(/[^\w]/g, '');
  for (const [entity, links] of Object.entries(entityMapping)) {
    const normalizedEntity = entity.toLowerCase().replace(/[^\w]/g, '');
    if (normalizedEntity.includes(normalizedKeyword) || normalizedKeyword.includes(normalizedEntity)) {
      return links;
    }
  }

  return [];
}

/**
 * 從標籤數組中提取實體關聯
 * @param {Array} tags 標籤數組
 * @returns {Array} 實體關聯數組
 */
export function extractEntityLinks(tags = []) {
  const entityLinks = [];

  tags.forEach(tag => {
    const links = getEntityLinks(tag);
    if (links.length > 0) {
      entityLinks.push({
        name: tag,
        sameAs: links
      });
    }
  });

  return entityLinks;
}